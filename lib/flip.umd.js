(function(s,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(s=typeof globalThis<"u"?globalThis:s||self,n(s.Flip={}))})(this,function(s){"use strict";class n{animate(){this.last(),this.invert(),this.play()}}const a=new Set;class h extends n{constructor(t,e=300,i=[]){if(a.has(t))throw new Error("Element has been registered");a.add(t),super(),this.isRunning=!1,this.el=t,this.animateOption=e,this.otherStyleKeys=i,this.init()}getRect(){const t=getComputedStyle(this.el),e=t.transform;this.el.style.transform="none";const i=this.el.getBoundingClientRect();this.el.style.transform=e;const l=i.top,f=i.left,r={};for(const o of this.otherStyleKeys)o!=="transform"&&(r[o]=t[o]);return{top:l,left:f,transform:e==="none"?"":e,styles:r}}init(){this.firstRect=this.getRect()}last(){this.lastRect=this.getRect()}invert(){const{left:t,top:e,transform:i,styles:l}=this.firstRect,{left:f,top:r,transform:o,styles:m}=this.lastRect,p=t-f,d=e-r;this.firstAnimateKeyframe={...l,transform:`translateX(${p}px) translateY(${d}px) ${i}`},this.lastAnimateKeyframe={...m,transform:o}}play(){if(this.isRunning)return;this.isRunning=!0,this.el.animate([this.firstAnimateKeyframe,this.lastAnimateKeyframe],this.animateOption).addEventListener("finish",()=>{this.isRunning=!1,a.delete(this.el)})}}s.Flip=h,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
